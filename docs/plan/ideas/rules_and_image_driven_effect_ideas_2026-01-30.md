# ルール/画像駆動を核にした effect アイデア（非SDF）

作成日: 2026-01-30

対象:

- タイル / 文法（Truchet / Wang / Penrose / L-system）
- 画像 / トーン駆動（濃淡→線化、エッジ→線化）

## 前提（共通）

- ルール系は “生成規則” が核。素材が弱くても成立しやすい（ただし破綻も規則に依存する）。
- 画像駆動は “入力の意味” が核。線化のルールをシンプルにすると破綻しにくい。

## 手法: タイル / 文法（Rules / Grammar）

局所ルールで大域パターンを作る。出力は最初からポリライン列になりやすく、プロッタ相性が良い。

### アイデア A: `E.truchet_tiles(bounds)`（Truchet 曲線タイル）

- ねらい: タイルごとの曲線片を繋げて、迷路/水路のような連続線を作る。
- 入出力: 入力=範囲（bounds）または `mask`, 出力=開/閉ポリライン（連結曲線）
- パラメータ案: `tile_size`, `variants`, `seed`, `clip`
- メモ: “線が必ず繋がる” 設計にすると、ペン運びが気持ちいい。

### アイデア B: `E.wang_tiles(bounds)`（Wang タイルで局所整合）

- ねらい: エッジ色制約で局所整合を作り、より“大域構造”のある迷路を生成する。
- 入出力: 入力=範囲 or `mask`, 出力=ポリライン列
- パラメータ案: `tile_set`, `tile_size`, `seed`, `solve_steps`
- メモ: ルールを 2〜3 色に絞ると、実装も見た目もシンプルに保てる。

### アイデア C: `E.penrose_tiling(bounds)`（準周期タイルの線画）

- ねらい: 周期ではない規則性で、手描きでは出しづらい“気配”を作る。
- 入出力: 入力=範囲, 出力=開ポリライン（タイル辺）
- パラメータ案: `scale`, `depth`, `draw`（edges/diagonals）, `clip`
- メモ: 辺全部を描くと黒くなりがちなので、選別（角度/長さ）と相性が良い。

### アイデア D: `E.lsystem(kind)`（L-system 植物/回路）

- ねらい: 樹形/蔓/回路図のような“記号的”な線を生成する。
- 入出力: 入力=文字列規則 or プリセット, 出力=開ポリライン（枝）
- パラメータ案: `axiom`, `rules`, `iters`, `angle`, `step`, `jitter`
- メモ: ルールは増やしすぎず、1〜2 系統で十分映える。

### アイデア E: `E.shape_grammar_fill(mask)`（形状内の文法フィル）

- ねらい: `mask` の内部を、文法（タイル/枝/アーチ）で埋める“パターン充填”にする。
- 入出力: 入力=`mask`, 出力=開/閉ポリライン（パターン）
- パラメータ案: `grammar`（選択）, `scale`, `density`, `seed`, `clip`
- メモ: “境界付近だけ密” など、SDF 的な発想も後段で足せる。

## 手法: 画像 / トーン駆動（Image-driven）

画像の濃淡やエッジを、線の密度・方向・長さに変換する。プロッタでは「黒ベタを避ける」設計（帯域/確率/ハッチ）が重要。

### アイデア A: `E.image_hatching(image)`（濃淡→ハッチ密度）

- ねらい: 古典的な “濃いほど線が多い” を、少ないルールで安定して出す。
- 入出力: 入力=`image`（＋任意で `mask`）, 出力=開ポリライン（ハッチ線）
- パラメータ案: `angles`（1〜2 個）, `base_spacing`, `tone_curve`, `seed`
- メモ: 角度は 1〜2 に絞ると綺麗。増やすほど黒くなる。

### アイデア B: `E.image_contours(image)`（輝度等値線/輪郭線）

- ねらい: 写真を “地図” に変換する。輪郭を線で拾うと情報量が保てる。
- 入出力: 入力=`image`, 出力=開/閉ポリライン（等値線）
- パラメータ案: `levels`, `blur`（前処理）, `grid_pitch`, `cleanup`
- メモ: 画像は事前に `lowpass/highpass` 的な処理があると選びやすい。

### アイデア C: `E.image_flowfield(image)`（構造テンソル→方向場）

- ねらい: 画像の“流れ”（筆致/輪郭方向）を方向場として取り出し、流線/ハッチにする。
- 入出力: 入力=`image`, 出力=開ポリライン（流線/ハッチ）
- パラメータ案: `sigma`（構造テンソル）, `seed_spacing`, `steps`, `min_sep`
- メモ: “方向だけ” 抽出して、密度は別のトーン場で決めると破綻しにくい。

### アイデア D: `E.image_stippling(image)`（トーン→点密度→線化）

- ねらい: 画像のトーンを点密度にして、点（または小記号）で描く。
- 入出力: 入力=`image`（＋任意で `mask`）, 出力=点列 or 記号ポリライン
- パラメータ案: `base_spacing`, `tone_curve`, `glyph`, `seed`
- メモ: 点を “小ループ” にするだけで、ペン先の味が出る。

### アイデア E: `E.image_spiral_halftone(image)`（スパイラル/単線ハーフトーン）

- ねらい: 1 本の線（スパイラル/蛇行）で濃淡を表現し、プロッタ向けの単線作品にする。
- 入出力: 入力=`image`, 出力=開ポリライン（単線）
- パラメータ案: `path_kind`（spiral/meander）, `spacing`, `tone_gain`, `smooth`
- メモ: “線間隔の変調” だけで濃淡が出せる。黒ベタになりにくい。

